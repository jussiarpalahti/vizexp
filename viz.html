<!doctype html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.8/d3.min.js" type="text/JavaScript"></script>
    <script src="https://d3js.org/d3-geo-projection.v1.min.js"></script>
    <script src="../js/colorbrewer.js"></script>
  </head>
  <body>
    <div id="controls">
    </div>
    <div id="viz">
      <svg style="width:600px;height:600px;" ></svg>
    </div>
    <script>
      var PromiseWrapper = (xhr, d) => new Promise(resolve => xhr(d, (p) => resolve(p)));

      Promise
        .all([
          PromiseWrapper(d3.json, "data/Maakunnat_wgs84_epgs4326.geojson"),
        ])
        .then(resolve => {
          createMap(resolve[0]);
        });

      function createMap(geojson) {
        
        var width = 800,
            height = 600;
        
        var svg = d3.select("svg");

        var projection = d3.geoTransverseMercator().fitSize([width, height], geojson)
                           .rotate([-27,-65,0])
                           .translate([width/2, height/2])
                           .scale([3800]);

        var path = d3.geoPath().projection(projection);
        
        var g = svg.append("g")
                   .style("stroke-width", "1.5px");

        g.selectAll('path')
          .data(geojson.features)
          .enter()
          .append('path')
          .attr('d', path)
          .style("fill", "lightblue")
          .style("stroke-width", "1")
          .style("stroke", "black");

        }

    </script>
  </body>
</html>
